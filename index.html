<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Kotoha AI - æ„›åª›çœŒæ»åœ¨ã‚µãƒãƒ¼ãƒˆ</title>
    
    <meta name="theme-color" content="#e65100">
    <meta name="description" content="æ„›åª›çœŒã§ã®é•·æœŸæ»åœ¨ã‚’ã‚µãƒãƒ¼ãƒˆã™ã‚‹AIã‚³ãƒŸãƒ¥ãƒ‹ã‚±ãƒ¼ã‚·ãƒ§ãƒ³ãƒ—ãƒ©ãƒƒãƒˆãƒ•ã‚©ãƒ¼ãƒ ">
    
    <link rel="apple-touch-icon" href="icons/icon-192x192.png">
    
    <link rel="manifest" href="manifest.json">
    
    <link rel="stylesheet" href="styles.css">
    
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+JP:wght@300;400;500;700&display=swap" rel="stylesheet">
    
    <style>
        /* ã‚¿ã‚¤ãƒ”ãƒ³ã‚°ã‚¤ãƒ³ã‚¸ã‚±ãƒ¼ã‚¿ãƒ¼ç”¨ã®CSS */
        .typing-indicator .message-bubble {
            padding: 16px 20px;
            background-color: #f5f5f5;
            border-radius: 18px;
            display: inline-block;
            max-width: none;
            width: auto;
        }

        .typing-dots {
            display: flex;
            align-items: center;
            gap: 4px;
        }

        .typing-dots span {
            width: 8px;
            height: 8px;
            border-radius: 50%;
            background-color: #999;
            animation: typing 1.4s infinite ease-in-out;
        }

        .typing-dots span:nth-child(2) {
            animation-delay: 0.2s;
        }

        .typing-dots span:nth-child(3) {
            animation-delay: 0.4s;
        }

        @keyframes typing {
            0%, 60%, 100% {
                transform: translateY(0);
                opacity: 0.5;
            }
            30% {
                transform: translateY(-10px);
                opacity: 1;
            }
        }

        /* é€ä¿¡ãƒœã‚¿ãƒ³ã®çŠ¶æ…‹æ”¹å–„ */
        .send-button:disabled {
            background-color: #ccc;
            cursor: not-allowed;
            opacity: 0.6;
        }

        .send-button {
            transition: all 0.2s ease;
        }

        /* ãƒãƒ£ãƒƒãƒˆãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã®ã‚¹ã‚¯ãƒ­ãƒ¼ãƒ«æ”¹å–„ */
        .chat-messages {
            scroll-behavior: smooth;
        }

        /* ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã®æ™‚é–“è¡¨ç¤ºæ”¹å–„ */
        .message-time {
            font-size: 12px;
            color: #666;
            margin-top: 4px;
        }

        /* æ”¹è¡Œã¨ãƒ•ã‚©ãƒ¼ãƒãƒƒãƒˆã®æ”¹å–„ */
        .message-bubble code {
            background-color: #f0f0f0;
            padding: 2px 4px;
            border-radius: 3px;
            font-family: monospace;
            font-size: 14px;
        }

        .message-bubble strong {
            font-weight: 600;
        }

        .message-bubble em {
            font-style: italic;
        }
    </style>
  <script src="https://cdn.jsdelivr.net/npm/marked/marked.min.js"></script>
</head>
<body>
    <div class="app-container">
        <header class="header">
            <div class="container">
                <div class="header-content">
                    <h1>Kotoha AI <span class="beta-badge">Î²</span></h1>
                    <p class="subtitle">æ„›åª›çœŒã§ã®æ»åœ¨ã‚’ã‚µãƒãƒ¼ãƒˆã™ã‚‹AIã‚¢ã‚·ã‚¹ã‚¿ãƒ³ãƒˆ</p>
                    
                    <div class="language-switcher">
                        <button id="lang-ja" class="lang-btn active">æ—¥æœ¬èª</button>
                        <button id="lang-en" class="lang-btn">English</button>
                    </div>
                    
                    <div id="user-info" class="user-info" style="display: none;">
                        <span id="user-display-name">ãƒ¦ãƒ¼ã‚¶ãƒ¼</span>
                        <button id="logout-btn" class="logout-btn">ãƒ­ã‚°ã‚¢ã‚¦ãƒˆ</button>
                    </div>
                </div>
                
                <button id="install-button" class="install-btn" style="display: none;">
                    <span>ğŸ“±</span> ã‚¢ãƒ—ãƒªã‚’ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«
                </button>
            </div>
        </header>

        <div class="progress-container">
            <div class="progress-bar">
                <div class="progress-fill" id="progress-fill"></div>
            </div>
            <div class="step-indicators">
                <div class="step active" data-step="1">èªè¨¼</div>
                <div class="step" data-step="2">ãƒ—ãƒ­ãƒ•ã‚£ãƒ¼ãƒ«</div>
                <div class="step" data-step="3">ç›¸è«‡</div>
                <div class="step" data-step="4">å±¥æ­´</div>
            </div>
        </div>

        <main class="main-content">
            <section id="section-1" class="section active">
                <div class="container">
                    <div class="section-header">
                        <h2>ã‚ˆã†ã“ã Kotoha AI ã¸</h2>
                        <p>æ„›åª›çœŒã§ã®æ»åœ¨ã‚’ã‚ˆã‚Šå¿«é©ã«ã™ã‚‹ãŸã‚ã€ã¾ãšã¯ã‚¢ã‚«ã‚¦ãƒ³ãƒˆã‚’ä½œæˆã—ã¾ã—ã‚‡ã†</p>
                        <div class="feature-highlights">
                            <div class="feature-item"><span class="feature-icon">ğŸšŒ</span><span>äº¤é€šæƒ…å ±</span></div>
                            <div class="feature-item"><span class="feature-icon">ğŸ¥</span><span>åŒ»ç™‚ã‚µãƒãƒ¼ãƒˆ</span></div>
                            <div class="feature-item"><span class="feature-icon">ğŸ“¶</span><span>ãƒãƒƒãƒˆæ¥ç¶š</span></div>
                            <div class="feature-item"><span class="feature-icon">ğŸŒ</span><span>æ–‡åŒ–ãƒ»ãƒãƒŠãƒ¼</span></div>
                        </div>
                    </div>
                    
                    <div id="auth-container" class="auth-container">
                        <form id="login-form" class="form-container">
                            <h3>ãƒ­ã‚°ã‚¤ãƒ³ / Sign In</h3>
                            <div class="form-group">
                                <label for="login-email">ãƒ¡ãƒ¼ãƒ«ã‚¢ãƒ‰ãƒ¬ã‚¹ / Email</label>
                                <input type="email" id="login-email" placeholder="your@email.com" autocomplete="email">
                            </div>
                            <div class="form-group">
                                <label for="login-password">ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰ / Password</label>
                                <input type="password" id="login-password" placeholder="ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰" autocomplete="current-password">
                            </div>
                            <div class="button-container">
                                <button type="button" class="btn btn-primary" id="login-btn">ãƒ­ã‚°ã‚¤ãƒ³ / Sign In</button>
                                <button type="button" class="btn btn-secondary" id="show-signup-btn">ã‚¢ã‚«ã‚¦ãƒ³ãƒˆä½œæˆ / Create Account</button>
                                <button type="button" class="btn btn-google" id="google-login-btn">
                                    <svg viewBox="0 0 48 48" width="18px" height="18px"><path fill="#EA4335" d="M24 9.5c3.54 0 6.71 1.22 9.21 3.6l6.85-6.85C35.9 2.38 30.47 0 24 0 14.62 0 6.51 5.38 2.56 13.22l7.98 6.19C12.43 13.72 17.74 9.5 24 9.5z"></path><path fill="#4285F4" d="M46.98 24.55c0-1.57-.15-3.09-.38-4.55H24v9.02h12.94c-.58 2.96-2.26 5.48-4.78 7.18l7.73 6c4.51-4.18 7.09-10.36 7.09-17.65z"></path><path fill="#FBBC05" d="M10.53 28.59c-.48-1.45-.76-2.99-.76-4.59s.27-3.14.76-4.59l-7.98-6.19C.92 16.46 0 20.12 0 24c0 3.88.92 7.54 2.56 10.78l7.97-6.19z"></path><path fill="#34A853" d="M24 48c6.48 0 11.93-2.13 15.89-5.81l-7.73-6c-2.15 1.45-4.92 2.3-8.16 2.3-6.26 0-11.57-4.22-13.47-9.91l-7.98 6.19C6.51 42.62 14.62 48 24 48z"></path><path fill="none" d="M0 0h48v48H0z"></path></svg>
                                    <span>Googleã§ãƒ­ã‚°ã‚¤ãƒ³</span>
                                </button>
                                <button type="button" class="btn btn-ghost" id="guest-login-btn">ã‚²ã‚¹ãƒˆã¨ã—ã¦åˆ©ç”¨ / Guest Mode</button>
                            </div>
                        </form>
                        
                        <form id="signup-form" class="form-container" style="display: none;">
                            <h3>ã‚¢ã‚«ã‚¦ãƒ³ãƒˆä½œæˆ / Create Account</h3>
                            <div class="form-group">
                                <label for="signup-email">ãƒ¡ãƒ¼ãƒ«ã‚¢ãƒ‰ãƒ¬ã‚¹ / Email</label>
                                <input type="email" id="signup-email" placeholder="your@email.com" autocomplete="email">
                            </div>
                            <div class="form-group">
                                <label for="signup-password">ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰ / Password</label>
                                <input type="password" id="signup-password" placeholder="8æ–‡å­—ä»¥ä¸Š" autocomplete="new-password">
                            </div>
                            <div class="form-group">
                                <label for="signup-password-confirm">ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰ç¢ºèª / Confirm Password</label>
                                <input type="password" id="signup-password-confirm" placeholder="ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰ã‚’å†å…¥åŠ›" autocomplete="new-password">
                            </div>
                            <div class="button-container">
                                <button type="button" class="btn btn-primary" id="signup-btn">ã‚¢ã‚«ã‚¦ãƒ³ãƒˆä½œæˆ / Create</button>
                                <button type="button" class="btn btn-secondary" id="show-login-btn">ãƒ­ã‚°ã‚¤ãƒ³ã«æˆ»ã‚‹ / Back to Login</button>
                            </div>
                        </form>
                    </div>
                </div>
            </section>

            <section id="section-2" class="section">
                <div class="container">
                    <div class="section-header">
                        <h2>ãƒ—ãƒ­ãƒ•ã‚£ãƒ¼ãƒ«è¨­å®š / Profile Setup</h2>
                        <p>ã‚ˆã‚Šé©åˆ‡ãªã‚µãƒãƒ¼ãƒˆã‚’æä¾›ã™ã‚‹ãŸã‚ã€åŸºæœ¬æƒ…å ±ã‚’æ•™ãˆã¦ãã ã•ã„</p>
                    </div>
                    
                    <form id="profile-form" class="form-container">
                        <div class="form-group">
                            <label for="display-name">è¡¨ç¤ºå / Display Name</label>
                            <input type="text" id="display-name" placeholder="Taro / John">
                        </div>
                        
                        <div class="form-group">
                            <label for="nationality">å›½ç± / Nationality</label>
                            <select id="nationality">
                                <option value="">é¸æŠã—ã¦ãã ã•ã„ / Select</option>
                                <option value="Japan">æ—¥æœ¬ / Japan</option>
                                <option value="USA">ã‚¢ãƒ¡ãƒªã‚« / USA</option>
                                <option value="Germany">ãƒ‰ã‚¤ãƒ„ / Germany</option>
                                <option value="France">ãƒ•ãƒ©ãƒ³ã‚¹ / France</option>
                                <option value="UK">ã‚¤ã‚®ãƒªã‚¹ / UK</option>
                                <option value="Australia">ã‚ªãƒ¼ã‚¹ãƒˆãƒ©ãƒªã‚¢ / Australia</option>
                                <option value="Canada">ã‚«ãƒŠãƒ€ / Canada</option>
                                <option value="South Korea">éŸ“å›½ / South Korea</option>
                                <option value="China">ä¸­å›½ / China</option>
                                <option value="other">ãã®ä»– / Other</option>
                            </select>
                        </div>

                        <div class="form-group">
                            <label for="languages">ä½¿ç”¨ã§ãã‚‹è¨€èª / Languages</label>
                            <div class="checkbox-group">
                                <label class="checkbox-item"><input type="checkbox" value="Japanese" id="lang-japanese"> æ—¥æœ¬èª / Japanese</label>
                                <label class="checkbox-item"><input type="checkbox" value="English" id="lang-english"> è‹±èª / English</label>
                                <label class="checkbox-item"><input type="checkbox" value="Chinese" id="lang-chinese"> ä¸­å›½èª / Chinese</label>
                                <label class="checkbox-item"><input type="checkbox" value="Korean" id="lang-korean"> éŸ“å›½èª / Korean</label>
                            </div>
                        </div>
                        
                        <div class="form-group">
                            <label for="stay-location">æ»åœ¨åœ°åŸŸ / Stay Location</label>
                            <select id="stay-location">
                                <option value="">é¸æŠã—ã¦ãã ã•ã„ / Select</option>
                                <option value="æ¾å±±å¸‚">æ¾å±±å¸‚ / Matsuyama City</option>
                                <option value="ä»Šæ²»å¸‚">ä»Šæ²»å¸‚ / Imabari City</option>
                                <option value="æ–°å±…æµœå¸‚">æ–°å±…æµœå¸‚ / Niihama City</option>
                                <option value="è¥¿æ¡å¸‚">è¥¿æ¡å¸‚ / Saijo City</option>
                                <option value="å®‡å’Œå³¶å¸‚">å®‡å’Œå³¶å¸‚ / Uwajima City</option>
                                <option value="other">ãã®ä»– / Other</option>
                            </select>
                        </div>

                        <div class="form-group">
                            <label for="stay-purpose">æ»åœ¨ç›®çš„ / Purpose</label>
                            <select id="stay-purpose">
                                <option value="">é¸æŠã—ã¦ãã ã•ã„ / Select</option>
                                <option value="working_holiday">ãƒ¯ãƒ¼ã‚­ãƒ³ã‚°ãƒ›ãƒªãƒ‡ãƒ¼ / Working Holiday</option>
                                <option value="study">ç•™å­¦ / Study</option>
                                <option value="work">å°±åŠ´ / Work</option>
                                <option value="tourism">è¦³å…‰ / Tourism</option>
                                <option value="family">å®¶æ—æ»åœ¨ / Family Visit</option>
                                <option value="other">ãã®ä»– / Other</option>
                            </select>
                        </div>

                        <div class="form-group">
                            <label for="stay-period">æ»åœ¨æœŸé–“ / Stay Period</label>
                            <div class="date-range">
                                <input type="date" id="stay-from">
                                <span>ã€œ</span>
                                <input type="date" id="stay-to">
                            </div>
                        </div>
                    </form>
                    
                    <div class="button-container">
                        <button class="btn btn-primary" id="save-profile-btn">ãƒ—ãƒ­ãƒ•ã‚£ãƒ¼ãƒ«ä¿å­˜ / Save Profile</button>
                    </div>
                </div>
            </section>

            <section id="section-3" class="section">
                <div class="container">
                    <div class="section-header">
                        <h2>AIç›¸è«‡ / AI Consultation</h2>
                        <p>ã‚«ãƒ†ã‚´ãƒªã‚’é¸æŠã—ã¦ã€æ°—è»½ã«ã”è³ªå•ãã ã•ã„</p>
                    </div>
                    <div class="category-selector">
                        <h3>ç›¸è«‡ã‚«ãƒ†ã‚´ãƒª / Category</h3>
                        <div class="category-grid">
                            <div class="category-card" data-category="transportation"><div class="category-icon">ğŸšŒ</div><div class="category-name">äº¤é€šãƒ»ç§»å‹•</div><div class="category-name-en">Transportation</div></div>
                            <div class="category-card" data-category="medical"><div class="category-icon">ğŸ¥</div><div class="category-name">åŒ»ç™‚ãƒ»å¥åº·</div><div class="category-name-en">Medical & Health</div></div>
                            <div class="category-card" data-category="connectivity"><div class="category-icon">ğŸ“¶</div><div class="category-name">ãƒãƒƒãƒˆãƒ»é€šä¿¡</div><div class="category-name-en">Internet & Communication</div></div>
                            <div class="category-card" data-category="accommodation"><div class="category-icon">ğŸ </div><div class="category-name">ä½å±…ãƒ»å®¿æ³Š</div><div class="category-name-en">Housing & Accommodation</div></div>
                            <div class="category-card" data-category="culture"><div class="category-icon">ğŸŒ</div><div class="category-name">æ–‡åŒ–ãƒ»ãƒãƒŠãƒ¼</div><div class="category-name-en">Culture & Etiquette</div></div>
                            <div class="category-card" data-category="general"><div class="category-icon">ğŸ’¬</div><div class="category-name">ä¸€èˆ¬ç›¸è«‡</div><div class="category-name-en">General</div></div>
                        </div>
                    </div>
                    <div id="consultation-interface" class="consultation-interface">
                        <div class="sample-questions">
                            <h4>ğŸ’¡ ã‚ˆãã‚ã‚‹è³ªå• / Frequently Asked Questions</h4>
                            <div class="question-chips">
                                <button class="question-chip" data-question="ãƒã‚¹ã®ä¹—ã‚Šæ–¹ãŒã‚ã‹ã‚Šã¾ã›ã‚“ã€‚ã©ã†ã™ã‚Œã°ã„ã„ã§ã™ã‹ï¼Ÿ">ãƒã‚¹ã®ä¹—ã‚Šæ–¹ã¯ï¼Ÿ</button>
                                <button class="question-chip" data-question="ç—…é™¢ã«è¡ŒããŸã„ã®ã§ã™ãŒã€äºˆç´„ã¯å¿…è¦ã§ã™ã‹ï¼Ÿ">ç—…é™¢ã®äºˆç´„æ–¹æ³•ã¯ï¼Ÿ</button>
                                <button class="question-chip" data-question="Wi-FiãŒä½¿ãˆã‚‹å ´æ‰€ã‚’æ•™ãˆã¦ãã ã•ã„ã€‚">Wi-Fiåˆ©ç”¨å ´æ‰€ã¯ï¼Ÿ</button>
                                <button class="question-chip" data-question="æ—¥æœ¬ã®ãƒãƒŠãƒ¼ã§æ³¨æ„ã™ã¹ãã“ã¨ã¯ã‚ã‚Šã¾ã™ã‹ï¼Ÿ">æ—¥æœ¬ã®ãƒãƒŠãƒ¼ã¯ï¼Ÿ</button>
                                <button class="question-chip" data-question="ç·Šæ€¥æ™‚ã¯ã©ã“ã«é€£çµ¡ã™ã‚Œã°ã„ã„ã§ã™ã‹ï¼Ÿ">ç·Šæ€¥æ™‚ã®é€£çµ¡å…ˆã¯ï¼Ÿ</button>
                            </div>
                        </div>
                        <div class="chat-container">
                            <div id="chat-messages" class="chat-messages">
                                <div class="message ai-message">
                                    <div class="message-avatar">ğŸ¤–</div>
                                    <div class="message-content">
                                        <div class="message-bubble">
                                            ã“ã‚“ã«ã¡ã¯ï¼Kotoha AIã§ã™ã€‚æ„›åª›çœŒã§ã®æ»åœ¨ã«é–¢ã™ã‚‹ã”è³ªå•ã«ã€ãªã‚“ã§ã‚‚ãŠç­”ãˆã—ã¾ã™ã€‚<br>
                                            ä¸Šè¨˜ã®ã‚µãƒ³ãƒ—ãƒ«è³ªå•ã‚’ã‚¯ãƒªãƒƒã‚¯ã™ã‚‹ã‹ã€ç›´æ¥ã”è³ªå•ã‚’å…¥åŠ›ã—ã¦ãã ã•ã„ã€‚<br><br>
                                            Hello! I'm Kotoha AI. Feel free to ask me anything about your stay in Ehime Prefecture.
                                        </div>
                                        <div class="message-time">Kotoha AI</div>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div class="chat-input-container">
                            <div class="selected-category" id="selected-category" style="display: none;">
                                <span>é¸æŠä¸­:</span>
                                <span id="selected-category-name"></span>
                                <button id="clear-category-btn">Ã—</button>
                            </div>
                            <div class="chat-input-wrapper">
                                <textarea id="chat-input" placeholder="è³ªå•ã‚’å…¥åŠ›ã—ã¦ãã ã•ã„... / Please enter your question..." rows="2"></textarea>
                                <button id="send-button" class="send-button" disabled>
                                    <svg width="20" height="20" viewBox="0 0 24 24" fill="currentColor"><path d="M2.01 21L23 12 2.01 3 2 10l15 2-15 2z"/></svg>
                                </button>
                            </div>
                            <div class="storage-settings">
                                <label class="checkbox-item">
                                    <input type="checkbox" id="store-consultation" checked>
                                    <span>ã“ã®ç›¸è«‡å†…å®¹ã‚’ä»Šå¾Œã®å‚è€ƒã®ãŸã‚ã«ä¿å­˜ã™ã‚‹ / Save this consultation for future reference</span>
                                </label>
                            </div>
                            <div class="chat-controls">
                                <button class="btn btn-secondary btn-small" id="clear-chat-btn">ãƒãƒ£ãƒƒãƒˆã‚’ã‚¯ãƒªã‚¢ / Clear Chat</button>
                            </div>
                        </div>
                    </div>
                </div>
            </section>

            <section id="section-4" class="section">
                <div class="container">
                    <div class="section-header">
                        <h2>ç›¸è«‡å±¥æ­´ / Consultation History</h2>
                        <p>éå»ã®ç›¸è«‡å†…å®¹ã‚’ç¢ºèªã§ãã¾ã™</p>
                    </div>
                    <div class="history-container">
                        <div class="filter-options">
                            <label for="history-category-filter">ã‚«ãƒ†ã‚´ãƒªã§çµã‚Šè¾¼ã¿:</label>
                            <select id="history-category-filter">
                                <option value="">ã™ã¹ã¦ / All</option>
                                <option value="transportation">äº¤é€šãƒ»ç§»å‹•</option>
                                <option value="medical">åŒ»ç™‚ãƒ»å¥åº·</option>
                                <option value="connectivity">ãƒãƒƒãƒˆãƒ»é€šä¿¡</option>
                                <option value="accommodation">ä½å±…ãƒ»å®¿æ³Š</option>
                                <option value="culture">æ–‡åŒ–ãƒ»ãƒãƒŠãƒ¼</option>
                                <option value="general">ä¸€èˆ¬ç›¸è«‡</option>
                            </select>
                        </div>
                        <div id="consultation-history" class="consultation-history">
                            <div class="no-history">
                                <p>ã¾ã ç›¸è«‡å±¥æ­´ã¯ã‚ã‚Šã¾ã›ã‚“ã€‚</p>
                                <p>No consultation history yet.</p>
                            </div>
                        </div>
                    </div>
                    <div class="button-container">
                        <button class="btn btn-secondary" id="back-to-consultation-btn">ç›¸è«‡ã«æˆ»ã‚‹ / Back to Consultation</button>
                        <button class="btn btn-primary" id="export-history-btn">å±¥æ­´ã‚’ã‚¨ã‚¯ã‚¹ãƒãƒ¼ãƒˆ / Export History</button>
                    </div>
                </div>
            </section>
        </main>
        
        <footer class="footer">
            <div class="container">
                <p>&copy; 2025 Kotoha AI - Powered by ã„ã‚ã¯TEC</p>
                <p class="footer-note">æ„›åª›æ–°èç¤¾ Ã— ã„ã‚ã¯TEC å…±åŒãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆ</p>
            </div>
        </footer>
    </div>
    
    <script type="module" src="./app.js"></script>

</body>
</html>
